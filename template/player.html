<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File To Link</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            background: #0e0d0d;
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            color: white;
            text-align: center;
            margin: 0;
            padding: 0;
        }

        .logo {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 24px;
            color: #03e9f4;
            font-weight: bold;
            z-index: 1;
            padding: 10px;
            background: #0e0d0d;
            border-radius: 5px;
            border: 2px solid;
            border-image-slice: 1;
            border-width: 2px;
            border-image-source: linear-gradient(45deg, #03e9f4, #ff005e, #03e9f4);
            animation: gradientBorder 3s linear infinite;
        }

        @keyframes gradientBorder {
            0% {
                border-image-source: linear-gradient(45deg, #03e9f4, #ff005e, #03e9f4);
            }
            100% {
                border-image-source: linear-gradient(405deg, #03e9f4, #ff005e, #03e9f4);
            }
        }

        .spacer {
            height: 80px;
        }

        .downloadBtn {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            padding: 15px 25px;
            background: linear-gradient(45deg, #03e9f4, #ff005e, #03e9f4);
            background-size: 200% 200%;
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            letter-spacing: 1px;
            font-family: 'Josefin Sans', sans-serif;
            transition: 0.5s;
            margin: 10px;
            cursor: pointer;
            animation: gradientBG 3s linear infinite;
            flex: 1 1 calc(25% - 20px);
            box-sizing: border-box;
            min-width: 200px;
        }

        @keyframes gradientBG {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }

        button:hover {
            color: #0e0d0d;
            box-shadow: 0 0 5px #03e9f4, 0 0 25px #03e9f4, 0 0 50px #03e9f4, 0 0 200px #03e9f4;
        }

        h2 {
            font-family: 'Josefin Sans', sans-serif;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="logo">Admins Hub</div>

    <div class="spacer"></div>

    <br />
    <div class="downloadBtn">
        <button onclick="openVideo('vlc')"><i class="fas fa-play"></i> WATCH ON VLC PLAYER</button>
        <button onclick="openVideo('mx')"><i class="fas fa-play"></i> WATCH ON MX PLAYER</button>
        <button onclick="openVideo('playit')"><i class="fas fa-play"></i> WATCH ON PLAYit PLAYER</button>
        <button onclick="openVideo('xplayer')"><i class="fas fa-play"></i> WATCH ON X PLAYER</button>
        <button onclick="playOnline()"><i class="fas fa-play"></i> PLAY ONLINE</button>
        <button onclick="downloadVideo()"><i class="fas fa-download"></i> DIRECT DOWNLOAD</button>
    </div>

    <script>
        // Declare directDownloadUrl in global scope
        let directDownloadUrl;

        // Run this code after the DOM is fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Base URL from template
            const baseUrl = "{{file_url}}";
            const streamableUrl = cleanUrl(baseUrl);
            directDownloadUrl = streamableUrl;

            // Detect if the page is opened in Telegram browser
            const isTelegram = isTelegramBrowser();
            const allButtons = document.querySelectorAll('.downloadBtn button');
            const playOnlineButton = document.querySelector('button[onclick="playOnline()"]');

            if (isTelegram) {
                // In Telegram, hide all buttons except "Play Online"
                allButtons.forEach(button => {
                    if (button !== playOnlineButton) {
                        button.style.display = 'none';
                    }
                });
            } else {
                // In other browsers (e.g., Chrome), hide "Play Online" button
                if (playOnlineButton) {
                    playOnlineButton.style.display = 'none';
                }
            }
        });

        // Function to clean the URL by removing '/watch/' segments and extra slashes
        function cleanUrl(url) {
            if (!url || (!url.startsWith('http://') && !url.startsWith('https://') && !url.startsWith('/'))) {
                console.error("Invalid streaming URL: " + url);
                return url || '';
            }

            // If it's a relative URL, it's already clean
            if (url.startsWith('/')) {
                return url;
            }

            try {
                let urlObj = new URL(url);
                let pathParts = urlObj.pathname.split('/').filter(part => part && part !== 'watch');
                urlObj.pathname = pathParts.length ? '/' + pathParts.join('/') : '/';
                return urlObj.toString();
            } catch (e) {
                console.error("Error cleaning URL:", url, e);
                return url;
            }
        }

        // Function to check if the browser is Telegram
        function isTelegramBrowser() {
            return navigator.userAgent.includes("Telegram");
        }

        // Function to open video in external players with http://
        function openVideo(player) {
            let url = '';
            // Construct absolute URL for intent
            const absoluteUrl = new URL(directDownloadUrl, window.location.origin).href;
            const urlWithoutScheme = absoluteUrl.replace(/^https?:\/\//, '');
            const scheme = 'http'; // Use http as per requirement
            switch (player) {
                case 'vlc':
                    url = `intent://${urlWithoutScheme}#Intent;package=org.videolan.vlc;type=video/*;scheme=${scheme};action=android.intent.action.VIEW;end`;
                    break;
                case 'mx':
                    url = `intent://${urlWithoutScheme}#Intent;package=com.mxtech.videoplayer.ad;type=video/*;scheme=${scheme};action=android.intent.action.VIEW;end`;
                    break;
                case 'playit':
                    url = `intent://${urlWithoutScheme}#Intent;package=com.playit.videoplayer;type=video/*;scheme=${scheme};action=android.intent.action.VIEW;end`;
                    break;
                case 'xplayer':
                    url = `intent://${urlWithoutScheme}#Intent;package=video.player.videoplayer;type=video/*;scheme=${scheme};action=android.intent.action.VIEW;end`;
                    break;
                default:
                    break;
            }

            if (url) {
                window.location.href = url;
                setTimeout(() => {
                    const isPlayerOpened = document.hidden;
                    if (!isPlayerOpened) {
                        window.location.href = `video://${absoluteUrl}`;
                        console.log(`Player ${player} not responding, falling back to default video handler`);
                    }
                }, 2000);
            }
        }

        // Function to open the page in Chrome with http://
        function playOnline() {
            let currentUrl = window.location.href;
            // Replace https:// with http:// as per requirement
            currentUrl = currentUrl.replace('https://', 'http://');
            // Chrome intent to open the same page in Chrome with http scheme
            const chromeIntent = `intent://${currentUrl.replace(/^https?:\/\//, '')}#Intent;package=com.android.chrome;scheme=http;end`;
            window.location.href = chromeIntent;

            // Fallback if Chrome doesn't open
            setTimeout(() => {
                if (!document.hidden) {
                    window.location.href = currentUrl; // Fallback to same URL
                    console.log("Chrome not responding, falling back to default handler");
                }
            }, 2000);
        }

        // Function to download the video with http://
        function downloadVideo() {
            if (directDownloadUrl) {
                const absoluteUrl = new URL(directDownloadUrl, window.location.origin).href;
                const httpUrl = absoluteUrl.replace('https://', 'http://');
                window.location.href = httpUrl;
            } else {
                console.error("No valid URL for download.");
            }
        }
    </script>

    <br /><br />
    <h2>Disclaimer:</h2>
    <p>The streaming links provided on this website are generated âš  automatically by users through our Telegram bot. Bot owner is Admins Hub. We do not host, control, or endorse any of the content streamed through these links. Users are solely responsible for the content they share, and we disclaim any liability for the legality, accuracy, or appropriateness of such content. Use discretion and adhere to copyright laws when accessing streaming content through our platform.</p>

    <br><br>
    <h2>Follow Now</h2>
    <div>
        <a href="https://t.me/Joinnowearn"><i class="fab fa-spotify fa-2x" style="color: #1DB954"></i></a>
        <a href="https://t.me/Joinnowearn"><i class="fab fa-pinterest fa-2x" style="color: #BD081C"></i></a>
        <a href="https://t.me/Joinnowearn"><i class="fab fa-dribbble fa-2x" style="color: #EA4C89"></i></a>
        <a href="https://t.me/Joinnowearn"><i class="fab fa-telegram fa-2x" style="color: #0088CC"></i></a>
    </div>
</body>

</html>
